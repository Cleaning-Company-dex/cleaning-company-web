{% extends "base.html" %}

{% block title %}Customer Dashboard - {{ business_name }}{% endblock %}

{% block content %}
<h2>Welcome, {{ customer.Name }}!</h2>

<!-- Account Overview -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
    <div class="card">
        <h4>Account Details</h4>
        <p style="color: #666;">
            <strong>Property Type:</strong> {{ customer.Business_Type | title }}<br>
            <strong>Square Feet:</strong> {{ customer.Square_Feet | int }}<br>
            <strong>Service Plan:</strong> {{ customer.Service_Frequency | replace('_', ' ') | title }}<br>
            <strong>Member Since:</strong> {{ customer.Added_Date | date }}
        </p>
    </div>
    
    <div class="card" style="background: #e8f5e9;">
        <h4>Total Spent</h4>
        <p style="font-size: 2rem; font-weight: bold; color: #27ae60;">
            {{ total_spent | currency }}
        </p>
    </div>
</div>

<!-- Upcoming Services -->
<div class="card">
    <h3>Upcoming Services</h3>
    {% if upcoming_jobs %}
        <table class="table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Service</th>
                    <th>Employee</th>
                    <th>Price</th>
                </tr>
            </thead>
            <tbody>
                {% for job in upcoming_jobs %}
                <tr>
                    <td>{{ job.Date | date }}</td>
                    <td>{{ job.Time }}</td>
                    <td>{{ job.Service_Type | title }}</td>
                    <td>{{ job.Employee if job.Employee != 'Unassigned' else 'To be assigned' }}</td>
                    <td>{{ job.Price | currency }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <a href="{{ url_for('customer.bookings') }}" class="btn btn-primary">View All Bookings</a>
    {% else %}
        <p>No upcoming services scheduled.</p>
        <a href="{{ url_for('customer.book_service') }}" class="btn btn-success">Book a Service</a>
    {% endif %}
</div>

<!-- Past Services -->
<div class="card">
    <h3>Recent Services</h3>
    {% if past_jobs %}
        <table class="table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Service</th>
                    <th>Employee</th>
                    <th>Price</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for job in past_jobs %}
                <tr>
                    <td>{{ job.Date | date }}</td>
                    <td>{{ job.Service_Type | title }}</td>
                    <td>{{ job.Employee }}</td>
                    <td>{{ job.Price | currency }}</td>
                    <td><span style="color: #27ae60;">âœ… Completed</span></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No completed services yet.</p>
    {% endif %}
</div>

<!-- Quick Actions -->
<div class="card" style="background: #f8f9fa;">
    <h3>Quick Actions</h3>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="{{ url_for('customer.book_service') }}" class="btn btn-success">Book New Service</a>
        <a href="{{ url_for('customer.payments') }}" class="btn btn-primary">View Payments</a>
        <a href="{{ url_for('customer.profile') }}" class="btn" style="background: #95a5a6; color: white;">Update Profile</a>
    </div>
</div>
{% endblock %}